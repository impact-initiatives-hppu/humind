---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# humind <a href="https://impact-initiatives-hppu.github.io/humind/"><img src="man/figures/logo.png" align="right" height="139" alt="humind website" /></a>

<!-- badges: start -->
[![R-CMD-check](https://github.com/impact-initiatives-hppu/humind/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/impact-initiatives-hppu/humind/actions/workflows/R-CMD-check.yaml)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/humind)](https://CRAN.R-project.org/package=humind)
[![Codecov test coverage](https://codecov.io/gh/impact-initiatives-hppu/humind/branch/main/graph/badge.svg)](https://app.codecov.io/gh/impact-initiatives-hppu/humind?branch=main)
<!-- badges: end -->

`humind` provides functions to compose usual humanitarian composite
indicators related to IMPACT Multi-Sector Needs Assessments (MSNAs). Such as:

- Specific indicators related to the MSNI framework: Sectoral Composites, MSNI Metrics and all recoding of indicators needed for these.
- Food security indicators (rCSI, LCSI, HHS, FCS).
- Recoding of WASH indicators to JMP classifications.

The package follows the 'Step - Composition' approach of IMPACT R framework.

## Installation

You can install the latest stable version of `humind` from GitHub:

``` r
# install.packages("devtools")
devtools::install_github("impact-initiatives-hppu/humind@v2025.1.2")
```

To confirm that you have the correct version, you should try the following:

```r
packageVersion("humind")
# v2025.1.2
```

## ðŸ“š Guidance Note

A comprehensive **Guidance Note** is available [here](https://acted.sharepoint.com/sites/IMPACT-Humanitarian_Planning_Prioritization/SitePages/MSNA%20analysis%20(LSG-MSNi).aspx) for all users of the `humind` package. This document provides essential background on the **MSNI framework** and includes sector-specific guidance. Each sector includes a **"Humind Data Workflow"** section, guiding users through the necessary steps and highlighting the relevant `humind` package functions to use.

> âš ï¸ **Users are strongly encouraged to thoroughly read this document** â€” particularly the *Data Workflow* sections â€” before starting any implementation work with Humind.

> ðŸ“Œ *Note: A more technical documentation guide will soon be available, detailing the full MSNI analysis workflow using `humind`, including runnable code examples. This guide will be directly integrated into the GitHub project to streamline the process.*

---

## ðŸ“– 2025 Programmatic Changes

* **Terminology migration**: All references to *acute need* are replaced with **severe need** (functions and outputs).  
* **Protection**: refined NA handling in rights and practices composites; DNK/PNTA no longer collapse the entire composite, but only nullify the affected sub-scores.  
* **WASH**: expanded handwashing facility categorization (`add_handwashing_facility_cat()`) with explicit soap-type handling and harmonized observed vs reported rules.  
* **Healthcare**: warnings and NA propagation in `add_loop_healthcare_needed_cat()` for inconsistent inputs.  
* **MSNI / sectoral composites**: consistent renaming of `*_in_acute_need` â†’ **`*_in_severe_need`** across all domains.  
* **Protection**: complete ravamp, based on a series of new Tier 1 indicators
related to Protection Needs. 

* **SNFI**:
  * Changes to the number of shelter issues and their mapping to the FW (from 8
  to 11 total issues).
  * Inclusion of one additional indicator to the security of tenure dimension:
  `hlp_eviction_risk.`
  * Hygiene indicator removed from the FDS series - making the total number of
  domestic tasks (and lighting) equal to 4 instead of 5.
  * Optional shelter damages component added.


* **Health**: removal of the WGQs from the framework.

* **WASH**: small changes to incorporate the self-reported hygiene variants (availability of soap & water) and map them to the JMP classifications.

* **Food Security**: new additional step to analyze the impact of livelihood coping
strategies on Food Consumption (changes done in [impactR4PHU](https://github.com/impact-initiatives/impactR4PHU)
and reflected in humind).

* **Education**: small changes to indicator naming to reflect "direct attack on
education". Indicator name was `edu_disrupted_occupation` and is now called
`edu_disrupted_attack.` 

---

## âš ï¸ Breaking Changes in 2025.1.2

* **Function rename**  
  - `is_in_acute_need()` â†’ **`is_in_severe_need()`**  

* **Output schema changes**  
  - All `*_in_acute_need` outputs â†’ **`*_in_severe_need`** (MSNI, WASH, Health, FoodSec, SNFI, Edu, Prot).  

* **WASH**  
  - Default parameter in `add_comp_wash()`: `drinking_water_quantity` now defaults to **`wash_hwise_drink`** (was `wash_drinking_water_quantity`).  
  - `add_handwashing_facility_cat()` requires new soap-type columns/args (`soap_type_observed`, `soap_type_reported`) and accepts vectorized â€œnoâ€ codes.  
  - Classification rules tightened: non-qualifying or undefined soap types now **demote `basic` â†’ `limited`**; NA handling stricter in reported path.  

* **Protection**  
  - DNK/PNTA handling refined: composites are NA **only if both sub-dimensions are NA**.  

* **Healthcare**  
  - `add_loop_healthcare_needed_cat()` returns NA with warnings when `needed == yes` and `received == NA`.  

---

## ðŸ“Œ Issues and Feedback

To help us respond efficiently, please select the most appropriate template when opening an issue:

- **[ðŸ› Bug report](https://github.com/impact-initiatives-hppu/humind/issues/new?template=bug-report.yml&labels=bug,triage)** â€“ Use this if youâ€™ve found a **reproducible error or unexpected behavior** in the code.  
- **[ðŸ§® Indicator Logic Change](https://github.com/impact-initiatives-hppu/humind/issues/new?template=indicator_logic_change.yml&labels=indicator-logic)** â€“ Use this for **adding, updating, or fixing logic related to indicators, scoring, or categorization** in the code.  
- **[âœ¨ Feature request](https://github.com/impact-initiatives-hppu/humind/issues/new?template=feature_request.yml&labels=enhancement)** â€“ Use this to **suggest a new feature or enhancement**.  
- **[ðŸ“– Documentation request](https://github.com/impact-initiatives-hppu/humind/issues/new?template=documentation_request.yml&labels=documentation)** â€“ Use this for **incorrect, missing, or unclear documentation**.  

**Not sure where your issue fits?**  
Open a **[blank issue](https://github.com/impact-initiatives-hppu/humind/issues/new)** and provide as much detail as possible.

---

## âš ï¸ Known Issues

### GitHub Credentials Error When Installing with devtools

When installing the package from GitHub using `devtools::install_github()`, you may encounter:

```r
> devtools::install_github("impact-initiatives-hppu/humind@v2025.2.0")
...
Error : Failed to install 'unknown package' from GitHub:
  HTTP error 401.
  Bad credentials
```

This issue is typically caused by outdated or incorrect GitHub credentials stored in R. For public repositories, no credentials are required. To resolve this, update or delete your stored credentials:

```r
library(gitcreds)
gitcreds_delete()
```

Then retry the installation.

---

## License

`humind` is released under the [MIT License](LICENSE.md).
